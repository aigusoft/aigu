const CACHE_NAME="Doc-V1.0.110";caches.keys().then((function(e){for(let t of e)t!==CACHE_NAME&&(console.log("ServiceWorker delete invalid cache:",t),caches.delete(t))})),this.addEventListener("install",(function(e){console.log("ServiceWorker install:",e),e.waitUntil(e.waitUntil(caches.open(CACHE_NAME).then((()=>self.skipWaiting()))))})),this.addEventListener("activate",(e=>{console.log("ServiceWorker activate:",e),e.waitUntil(self.clients.claim())}));var hotCache={};function contentType(e){return{html:"text/html",css:"text/css",json:"application/json",js:"text/javascript",svg:"image/svg+xml",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp",ico:"image/x-icon",mp3:"audio/mpeg",mp4:"video/mp4",txt:"text/plain"}[e.replace(/^.*\./,"")]||"text/plain"}this.addEventListener("fetch",(function(e){let t=decodeURI(e.request.url).replace(/[#\?].*$/,"");hotCache[t]?(console.log("---\x3e SW FETCH Cache",t),e.respondWith(new Response(hotCache[t],{headers:new Headers({"Content-Type":contentType(t)})}))):e.respondWith(caches.match(t).then((function(e){return e||fetch(t).then((function(e){if(!e||200!==e.status)return e;if(t.startsWith("http://localhost")||t.startsWith("http://127.0.0.1")||t.startsWith("https://wc-ex.com")||t.startsWith("https://www.wc-ex.com"))return fetch(t);const n=e.clone();return caches.open(CACHE_NAME).then((function(e){e.put(t,n)})),e}))})))})),this.addEventListener("message",(function(e){const{type:t,data:n}=e.data;switch(t){case"hotCacheSet":console.log("sw hotCacheSet",n),hotCache[n.file]=n.text;break;case"hotCacheClean":n.files&&n.files.length?n.files.forEach((e=>{delete hotCache[e],console.log("sw hotCacheClean",e)})):(hotCache={},console.log("sw hotCacheClean all"))}}));