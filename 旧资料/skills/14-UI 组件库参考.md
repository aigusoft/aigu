# 14｜UI 组件库参考

`@wcex/ui` 是官方提供的 Web Components 组件库，覆盖导航、表单、弹层、编辑器、路由等常用场景。只需通过 `<meta name="module" pkg="@wcex/ui">` 声明即可按需加载。本章列出核心组件、依赖注入方式与常见配合模式。

## 14.1 引入方式
```html
<template>
  <meta name="module" pkg="@wcex/ui" version="1.1.17" />
  <wcex-ui.ui !sync></wcex-ui.ui>      <!-- 可选：加载顶层 UI 管理器 -->
</template>
```
- 建议在应用入口提前加载 `wcex-ui.ui`（带 `!sync` 表示同步初始化），它会注入侧边栏、弹窗、全局样式、开发者工具等辅助组件。
- `wcex-ui.dev` 提供开发调试面板；生产环境可移除。
- UI 组件沿用语义化配色，默认与 `$color`、`$Colors` 协同。

## 14.2 基础组件
| 组件                     | 功能概述                                                             | 示例                                                                 |
| ------------------------ | -------------------------------------------------------------------- | -------------------------------------------------------------------- |
| `<wcex-ui.btn>`          | 带渐变和阴影的按钮，支持 `flat`、`block`、`vert` 等属性               | `<wcex-ui.btn $color="$color.pri" flat>确定</wcex-ui.btn>`           |
| `<wcex-ui.icon>`         | 图标组件，支持设置 `pkg`（图标包）、`type`、`icon`、`size`、`active` | `<wcex-ui.icon icon="person" size="2"></wcex-ui.icon>`               |
| `<wcex-ui.badge>`        | 角标，用于显示数字或状态，可通过 `flat`、`pos`、`x`、`y` 控制位置。  | `<wcex-ui.badge value="99" flat pos="r"></wcex-ui.badge>`            |
| `<wcex-ui.progress>`     | 进度条（可定制），支持动画。                                         | `<wcex-ui.progress value="0.4"></wcex-ui.progress>`                  |
| `<wcex-ui.tags>`         | 标签集合，支持选择/多选。                                            | `<wcex-ui.tags $options="tagList" $$="selected"></wcex-ui.tags>`     |

## 14.3 布局与面板
| 组件                   | 描述                                                                                           |
| ---------------------- | ---------------------------------------------------------------------------------------------- |
| `<wcex-ui.panel>`      | 可折叠面板，可搭配 `slot="title"`、`slot="icon"`、`closeable`、`$open` 等属性控制展开状态。     |
| `<wcex-ui.section>`    | 分区容器，内置标题与展开/收起逻辑。                                                            |
| `<wcex-ui.tabs>` / `<wcex-ui.tab>` | 选项卡容器，`$tabs` 可传对象或数组，`$$` 双向绑定当前索引。                              |
| `<wcex-ui.list>`       | 列表组件，支持 `$items`、`$flag-icon`、`$flag-color`、`$color` 等属性，并可插入自定义内容。    |
| `<wcex-ui.nav>`        | 路由导航（详见第 10 章），自动匹配当前路由并设置 `checked`。                                  |
| `<wcex-ui.page>`       | 页面容器，通常与 `<wcex-ui.route>` 结合。                                                      |

常见用法（文档左侧导航）：
```html
<wcex-ui.panel $textonly="min" $open="1">
  <wcex-ui.list $items="menuItems" $$="$root.value">
    <div $for="menuItems" @click="$router.go('wcex-doc.doc',{url:value.path})">
      <wcex-ui.icon $show="!min" $icon="value.icon?.name"></wcex-ui.icon>
      <span $>value.name</span>
    </div>
  </wcex-ui.list>
</wcex-ui.panel>
```

## 14.4 表单与交互
| 组件                     | 描述                                                                                          |
| ------------------------ | --------------------------------------------------------------------------------------------- |
| `<wcex-ui.input>`        | 文本输入框，支持配色、插槽图标、校验提示，兼容 `$$` 双向绑定。                                |
| `<wcex-ui.select>`       | 下拉选择，配合 `$options`、`$$` 使用。                                                        |
| `<wcex-ui.droplist>`     | 下拉列表，可自定义 `slot="selected"`、`slot="item-*"` 显示项。                                |
| `<wcex-ui.radio>` / `<wcex-ui.checkbox>` | 单选/复选包装，内置样式。                                                              |
| `<wcex-ui.table>`        | 表格组件，包含排序、分页等高级功能（视版本实现）。                                           |
| `<wcex-ui.tree>`         | 树形结构展示，支持递归数据、懒加载。                                                         |

示例（字体选择器片段）：
```html
<wcex-ui.droplist $items="allLang" value="cn">
  <div slot="selected" $item="$slot?.items?.[value]" class="row center">
    <wcex-ui.icon $icon="item?.icon?.icon"></wcex-ui.icon>
    <div $>item?.display</div>
  </div>
</wcex-ui.droplist>
```

## 14.5 弹层与侧边栏
`wcex-ui.ui` 注入以下全局容器：`<pop->`、`<side->`、`<dialog->` 等。可通过 `$side`、`$pop`、`$dialog`（UI 库提供的工具函数）打开：
```html
@click="$side('wcex-doc.com-font_select',{pos:'r',size:'20em',clip:false,autoclose:true})"
```
- `pos`：出现方向（`l`/`r`/`t`/`b`）。
- `size`：侧边栏宽高，如 `'20em'`。
- `clip`：是否裁剪内容。
- `autoclose`：点击外部是否自动关闭。
- 类似地，`$pop` 可打开浮动弹层，`$dialog` 用于对话框。

## 14.6 编辑器与展示
| 组件                     | 描述                                                                        |
| ------------------------ | --------------------------------------------------------------------------- |
| `<wcex-ui.monaco>`       | 基于 Monaco Editor 的代码编辑器，配合 `$file`、`@content`、`$emit('reload')` 使用。 |
| `<wcex-ui.marked>`       | Markdown 渲染器，支持目录生成（`toc` 属性）、语法高亮。                      |
| `<wcex-ui.marked-toc>`   | 文档目录面板，可与 `marked` 组件联动显示结构。                               |
| `<wcex-ui.echarts>`      | ECharts 图表封装，需通过 `<meta name="module" pkg="echarts">` 引入依赖。     |
| `<wcex-ui.toast>`        | 消息提示（全局定位），可通过 `$emit` 或 UI 工具方法触发。                   |
| `<wcex-ui.dialog>`       | 弹窗组件，支持插槽结构、按钮自定义。                                         |

示例：
```html
<wcex-ui.monaco style="height: 400px" $file="monacoFile" @content="onCodeChange($ev)"></wcex-ui.monaco>
```

## 14.7 路由与页面组件
| 组件                     | 描述                                                                                    |
| ------------------------ | --------------------------------------------------------------------------------------- |
| `<wcex-ui.route>`        | 路由容器（见第 10 章），根据 `$router` 状态渲染目标组件。                              |
| `<wcex-ui.nav>`          | 导航栏，自动匹配当前路由。                                                              |
| `<wcex-ui.appbar>`       | 顶部应用栏，支持菜单、搜索、设置等 Slot。                                              |
| `<wcex-ui.side>`         | 侧边栏容器，与 `$side` 配合实现抽屉效果。                                              |
| `<wcex-ui.dialog>`       | 对话框容器，嵌套在 `dialog-` 插槽内。                                                   |
| `<wcex-ui.dev>`          | 开发者工具界面（含元素选择、配置面板等），在生产环境可移除。                          |

## 14.8 依赖与辅助模块
- UI 库内部使用 `lodash.throttle`、`lodash.debounce`、`marked`、`monaco-editor` 等第三方包，使用时需要保证这些依赖可从 CDN 或本地获取。通过 `<meta name="module">` 声明 `@wcex/ui` 即可自动加载依赖。
- 某些组件（如 `wcex-ui.marked`）暴露语音朗读或 TTS 插槽，可按需接入自定义实现。

## 14.9 开发调试建议
- 在入口组件中引入 `<wcex-ui.ui !sync>` 一次即可，让全局弹层/侧栏能力常驻。
- 使用 `wcex-ui.dev` 打开调试界面，能查看元素结构、修改样式、执行脚本。
- UI 组件大量使用 `$color` 与 `$Colors`，请确保全局设置了合适的配色（见第 8 章）。
- 若需要自定义图标库，可调用 `wcex-doc.com-icons`（示例组件）浏览并复制 `<wcex-ui.icon>` 代码片段。

## 14.10 与业务组件的组合
UI 组件多数通过属性和插槽暴露配置，适合由自动化系统按照约定生成。例如：
```html
<wcex-ui.panel $open="1">
  <div slot="title">统计概览</div>
  <wcex-ui.tabs $tabs="tabs" $$="current">
    <section $for="tabs" slot="panel">
      <div :>${value.title}</div>
      <wcex-ui.echarts $if="value.chart" $src="value.chart"></wcex-ui.echarts>
    </section>
  </wcex-ui.tabs>
</wcex-ui.panel>
```
此结构展示了面板 + 标签页 + 图表的组合方式，自动化生成器只需填充 `tabs` 数据即可。

通过熟悉这些组件及其属性，可以显著降低 UI 编写成本，为模型生成的页面提供丰富的现成积木。

## 智能体提示
- 引导用户使用 UI 组件前，提醒添加 `<meta name="module" pkg="@wcex/ui">`，必要时同步加载 `wcex-ui.ui`。
- 当描述组件属性时，强调其与 `$color`、`$Colors` 的协同，例如按钮/图标的配色应引用语义色。
- 对弹层与侧边栏的需求，优先推荐 `$side`/`$pop` 工具函数，说明关键选项 `pos`、`size`、`autoclose`。
- 如果需要复杂编辑器或 Markdown 预览，指出 `wcex-ui.monaco`、`wcex-ui.marked` 可直接使用，并提示通过 `<meta module>` 引入对应第三方依赖。
