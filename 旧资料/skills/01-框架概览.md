# 01｜框架概览

WCEX（Web Component EXtension）是一套基于原生 Web Components 的实时前端框架。它保留了 Vue 等现代 MVVM 框架的核心能力（数据绑定、依赖追踪、指令语法），同时强化了以下特性：

- **HTML First**：组件即 HTML 文件，以 `<template>` 为根节点，支持内联/外链脚本与样式。无需单独的编译描述语言，浏览器可直接解析结构。
- **真实 DOM 与 Shadow DOM 混合**：模板直接作用于真实 DOM，充分利用原生生命周期，同时依靠 Shadow DOM 与作用域隔离避免样式/变量污染。
- **实时加载**：当页面引用自定义标签时，运行时会按照标签名解析、定位并按需拉取组件。无论组件位于本地目录还是 npm 包，只要声明即可加载。
- **无打包开发体验**：开发阶段不需要手动打包或引入构建工具。CLI 自动监视文件变化、编译 TypeScript 并通过 WebSocket 下发热更新。
- **完整 WebComponents 语义**：`<template>` 属性即可声明组件属性、类型、事件；Shadow DOM、`slot`、`customElements` 均遵循浏览器规范。
- **语义化配色与主题系统**：通过 `$color`/`$Colors`、`meta name="colors"` 等机制提供动态颜色绑定、自动明暗模式切换与配色表管理。
- **插件与可插拔运行时**：核心运行时通过 `WCEX.usePlugins` 暴露模板、作用域、组件生命周期钩子，便于注入监控、调试或业务工具。
- **内建热更新管线**：开发模式自动建立 `/_hotws` WebSocket，配合 `HotLoader` 按组件粒度重载模板与脚本，保留现有作用域状态。
- **模块自动发现**：在 HTML 中使用 `<meta name="module">` 声明依赖后，CLI `wcex dev` 会检测并自动安装 npm 包，运行时负责按需加载（支持 CJS/ESM/AMD）。
- **高可扩展性**：框架提供 `Scope` 抽象，开放 `$watch`、`$emit`、`$router`、`$path` 等工具方法，便于组合第三方库、实现复杂交互或接入服务端能力。
- **TypeScript 全链路支持**：组件可直接引用同名 `.ts` 文件，内联 `<script>` 亦可返回 TypeScript 定义的类，CLI 负责增量编译与类型提示。
- **UI 生态与 Playground**：官方 `@wcex/ui` 组件库覆盖按钮、面板、弹层、路由容器等常用元素；文档与示例内置 Playground，可在 Service Worker 热缓存下实时预览变更。

## 与 Vue 等 MVVM 框架的关键差异
- **运行时直接使用 WebComponents**：无需虚拟 DOM/编译器；自定义标签即最终渲染结果，真实 DOM 操作成本更低。
- **无构建依赖**：默认只需引入 `<script src=".../wcex/index.js">` 即可运行。打包仅在发布阶段通过 `wcex build` 完成。
- **模板指令在属性级别声明**：`$`、`:`、`$$` 等绑定直接作用于标准 HTML 属性/文本节点，无需单独模板语法文件。
- **模块加载靠 `<meta name="module">` 声明**：开发服务会按需安装 npm 依赖，运行时根据声明决定加载模式与文件位置。
- **配色与资源统一抽象**：`$color.*`、`$Colors.*`、`$path()`、`meta name="npm"` 等帮助在不同组件/包之间共享资源、颜色与 CDN 设置。

## 核心能力一览
| 能力                     | 描述                                                                 | 底层支持                                                   |
| ------------------------ | -------------------------------------------------------------------- | ---------------------------------------------------------- |
| 数据绑定                 | `$attr=""` 数值绑定、`:attr=""` 模板绑定、`$>` 文本、`$$` 双向绑定等 | 依赖追踪 + Proxy 作用域                                    |
| 控制语句                 | `$if` 条件、`$show` 显隐、`$for` 循环（支持索引/键）、`$cmpt` 动态组件 | 指令解析 + 局部作用域                                      |
| 事件与生命周期           | `@event` + 修饰符、`@ready`/`@create`/`@destroy`/`@timer`             | 自定义元素生命周期 + 事件代理                              |
| 模块化与依赖管理         | `<meta name="module" ...>`、`<script scope="x" src="pkg">`           | CLI 解析 + 运行时模块加载器                                |
| 路由                     | Hash 分区路由、`$router.go()`、`route` 容器                          | 内置 Router + `window` 事件 `route-change`                 |
| 主题/配色                | `meta name="colors"`、`$color` 语义色、`$Colors.set/switchMode`      | 配色调度器 + CSS 变量注入                                 |
| CLI 工具                 | `wcex dev/init/build/pack/test`                                      | Node.js + Express + Watchpack + Puppeteer                  |
| UI 组件生态              | `@wcex/ui`：按钮、列表、弹窗、编辑器、图标、路由面板等               | 组件即 WebComponent，可按需通过 `<meta module>` 自动加载   |
| 插件与运行时扩展         | `WCEX.usePlugins()` 挂载调试、监控、Scope 扩展                      | `plugins` 管理器串联 tpl/wc/scope 阶段                     |
| 热更新与调试             | CLI 热更新、`HotLoader`、`localStorage.__DEV` 指向本地包              | WebSocket + 模板替换 + UMD 缓存失效                        |

运行时代码会在全局注入 `window.WCEX`，提供 `usePlugins / registerElement / watch / noWatch / parseTag / buildTag` 等工具，并暴露 `npmUrl`、`modules`、`amdloader` 与最近一次初始化耗时，便于调试与二次封装。

> 框架坚持“简凝精简”的设计哲学：HTML 即组件、声明即依赖、属性即可配置。理解并掌握各章节后，可以在不依赖传统打包体系的情况下构建完整应用。智能体在生成代码时，应优先复用这些约定以保持一致性。

## 智能体提示
- 在回答关于 WCEX 的高层问题时，优先引用本章概念对比表，避免与 Vue/React 的差异被忽略。
- 生成组件骨架时，记得强调 `HTML First` 和 `<meta name="module">` 的依赖声明模式，以免误用传统打包配置。
- 当用户询问热更新或插件能力，请指向 “内建热更新管线” 和 “插件与可插拔运行时” 两节，说明对应工具链位置。
- 如需解释 CLI 能力，概述本章“核心能力一览”表格中 CLI 行即可，其他细节在第 13 章。
